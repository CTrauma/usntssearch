<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<title>NZB MegasearcH</title>
<style type="text/css">
<!--
@import url("static/style.css");
-->
</style>
</head>
<body>
<form action="/" method="post" name="cfgform">
<table id="results" summary="Config" style="width: 420px;"><thead>
<tr><th scope="col">General Options</th></tr></thead><tbody>
	<tr>
		<td>Port: <input type="input" name="port" value="{{ genopt['portno'] }}" size="10"></td>
	</tr>	
	<tr>
		<td>	User: <input type="input" name="general_usr" value="{{ genopt['general_usr'] }}" size="18">
			Pass: <input type="password" name="general_pwd" value="{{ genopt['general_pwd'] }}" size="18"></td>
	</tr>
	<tr>	
			<td><input type="checkbox" name="https" {{ genopt['general_https_verbose'] }} >HTTPS Enabled </td>
	</tr>					
</tbody></table>

<table id="results" summary="SendtoSAB" style="width: 420px;"><thead>
<tr><th scope="col">SabNZB Integration</th></tr></thead><tbody>
	<tr>	
			<td>Url: <input type="text" name="sabnzbd_url" value="{{ genopt['sabnzbd_url'] }}" size="18">
			API Key: <input type="text" name="sabnzbd_api" value="{{ genopt['sabnzbd_api'] }}" size="18"></td>
			
	</tr>					
</tbody></table>


<table id="results" summary="Config" style="width: 420px;"><thead>
<tr><th scope="col">Specially supported engines</th></tr></thead><tbody>
{% for c in cfg_bi -%}
	<tr>
		<td>
			<input type="checkbox" name="bi_host{{ c['idx'] }}active" value="1" size="40" {{ c['stchk'] }}> {{ c['humanname'] }}
			<input type="hidden" name="bi_host{{ c['idx'] }}" value="{{ c['type'] }}" size="40">
			<input type="hidden" name="bi_host{{ c['idx'] }}speed" value="{{ c['speed_class'] }}" size="40">
			{% if c['flogin'] == 1-%}
				-- login: <input type="text" name="bi_host{{ c['idx'] }}login" value="{{ c['loginname'] }}" size="12"> 
				pwd: <input type="password" name="bi_host{{ c['idx'] }}pwd" value="{{ c['loginpwd'] }}" size="12"> 
			{%- endif %}	
		</td>
	</tr>
{%- endfor %}	
</tbody></table>
<table id="results" summary="Config" style="width: 300px;"><thead>
<tr><th scope="col">Newznab Host (API)</th><th scope="col">API key</th><th scope="col">Timeout</th></tr></thead><tbody>
{% for c in cfg -%}
	{% if c['builtin'] == 0-%}
		<tr>
		<td><input type="text" name="host{{ c['idx'] }}" value="{{ c['url'] }}" size="40"></td>
		<td><input type="text" name="API{{ c['idx'] }}" value="{{ c['api'] }}" size="40">
		<input type="hidden" name="type{{ c['idx'] }}" value="NAB" size="40">
		<input type="hidden" name="host{{ c['idx'] }}active" value="1" size="40"></td>

		<td><span>
		<select  name="selspeed{{ c['idx'] }}">
			{% for sopt in c['selspeed_sel'] -%}
				<option value={{ sopt[0] }} {{ sopt[2] }}>{{ sopt[1] }}</option>
			{%- endfor %}
		</select>
		</span></td>

		</tr>
	{%- endif %}	
{%- endfor %}	
{% for q in range(cnt,cnt_max) -%}
		<tr>
		<td><input type="text" name="host{{ q }}" value="" size="40"></td>
		<td><input type="text" name="API{{ q }}" value="" size="40">
		<input type="hidden" name="type{{ q }}" value="NAB" size="40">
		<input type="hidden" name="host{{ q }}" value="1" size="40"></td>

		<td><span>
		<select  name="selspeed{{ q }}">
			{% for sopt in sel_speedopt_basic -%}
				<option value={{ sopt[0] }} {{ sopt[2] }}>{{ sopt[1] }}</option>
			{%- endfor %}
		</select>
		</span></td>

{%- endfor %}	
</tbody></table>


<table id="results" summary="NZConfig_web" style="width: 300px;"><thead>
<tr><th scope="col">Newznab Host (Web)</th><th scope="col">Username</th><th scope="col">Password</th><th scope="col">Timeout</th></thead></tr><tbody>
{% for c in cfg_dp -%}
		<tr>
		<td><input type="text" name="ds_host{{ c['idx'] }}" value="{{ c['url'] }}" size="40"></td>
		<td><input type="text" name="ds_usr{{ c['idx'] }}" value="{{ c['user'] }}" size="18"></td>
		<td><input type="password" name="ds_pass{{ c['idx'] }}" value="{{ c['pwd'] }}" size="18"></td>
		<input type="hidden" name="ds_type{{ c['idx'] }}" value="DSN" size="40">
		<input type="hidden" name="ds_host{{ c['idx'] }}active" value="1" size="40"></td>

		<td><span>
		<select  name="ds_selspeed{{ c['idx'] }}">
			{% for sopt in c['selspeed_sel'] -%}
				<option value={{ sopt[0] }} {{ sopt[2] }}>{{ sopt[1] }}</option>
			{%- endfor %}
		</select>
		</span></td>

		</tr>
{%- endfor %}	
{% for q in range(cnt,cnt_max) -%}
		<tr>
		<td><input type="text" name="ds_host{{ q }}" value="" size="40"></td>
		<td><input type="text" name="ds_usr{{ q }}" value="" size="18">
		<td><input type="text" name="ds_pass{{ q }}" value="" size="18">
		<input type="hidden" name="ds_type{{ q }}" value="DSN" size="40">
		<input type="hidden" name="ds_host{{ q }}" value="1" size="40"></td>

		<td><span>
		<select  name="ds_selspeed{{ q }}">
			{% for sopt in sel_speedopt_basic -%}
				<option value={{ sopt[0] }} {{ sopt[2] }}>{{ sopt[1] }}</option>
			{%- endfor %}
		</select>
		</span></td>

		
		</tr>
{%- endfor %}	
</tbody></table>


<div style="margin: 45px">
	<input type="submit" value="Save" style="width: 80px; font: bold 16px &#39;Lucida Sans Unicode&#39;, &#39;Lucida Grande&#39;, Sans-Serif; ">
	<input type="button" style="width: 80px; font: 16px &#39;Lucida Sans Unicode&#39;, &#39;Lucida Grande&#39;, Sans-Serif; " value="Cancel" onclick="location.href=&#39;\/&#39;;">
	<input type="button" style="width: 80px; font: 16px &#39;Lucida Sans Unicode&#39;, &#39;Lucida Grande&#39;, Sans-Serif; " value="TEST" onclick="test()">
</div></form>


	    <script type="text/javascript"> 
			function test()
			{
				
				var port_v = cfgform.port.value;
				chk1 = /^\d+$/.test(port_v);
				if(!chk1 || (chk1==true && (parseInt(port_v)> 65535 ||  parseInt(port_v)< 1024 )) )
				{
					alert('ERROR: [Port] is a number-only field between [1024,65535]');
					return false
				}	
				
				var usr_v = cfgform.general_usr.value.replace(/\s+/g, ' ')
				var pwd_v = cfgform.general_pwd.value.replace(/\s+/g, ' ')
				if (((usr_v.length == 0) && (pwd_v.length > 0)) || ((usr_v.length > 0) && (pwd_v.length == 0)))
				{
					alert('ERROR: [User and Password] must be either both empty or both filled');
					return false
				}	

				var sabnzbd_url_v = cfgform.sabnzbd_url.value.replace(/\s+/g, ' ')
				var sabnzbd_api_v = cfgform.sabnzbd_api.value.replace(/\s+/g, ' ')
				if ((sabnzbd_api_v.length > 0) && (sabnzbd_url_v.length == 0))
				{
					alert('ERROR: [SAB url and api] url missing with provided API key');
					return false
				}	
				
				{% for c in cfg_bi -%}				
					{% if c['flogin'] == 1-%}
						var bi_login_v{{ q }} = cfgform.bi_host{{ c['idx'] }}login.value.replace(/\s+/g, ' ')
						var bi_pwd_v{{ q }} = cfgform.bi_host{{ c['idx'] }}pwd.value.replace(/\s+/g, ' ')
						var bi_active_v{{ q }} = cfgform.bi_host{{ c['idx'] }}active.checked
						if ( ((bi_login_v{{ q }}.length == 0) || (bi_pwd_v{{ q }}.length == 0)) && bi_active_v{{ q }} )
						{
							alert('ERROR: Enter user and password for {{ c['humanname'] }}');
							return false
						}	
					{%- endif %}	
				{%- endfor %}	
				
				{% for q in range(0,cnt_max) -%}
				
					alert(cfgform.host{{ q }}.value)
					var bi_host{{ q }} = cfgform.host{{ q }}.value.replace(/\s+/g, ' ')
					var bi_hostapi{{ q }} = cfgform.API{{ q }}.value.replace(/\s+/g, ' ')

					if ((bi_host{{ q }}.length == 0) || (bi_hostapi{{ q }}.length > 0))
					{
						alert('ERROR: Newznab Host (API) #{{ q }}. Enter url for the given API');
						return false
					}	
					
				{%- endfor %}

				
			}
	    </script>


</body></html>
